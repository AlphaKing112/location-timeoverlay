<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Set Overlay Location</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #111;
      color: white;
    }
    input, button {
      padding: 10px;
      margin-top: 10px;
      width: 300px;
    }
    pre {
      background: #222;
      padding: 10px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h2>üåç Update Overlay Location</h2>
  <input id="cityInput" placeholder="Enter City (e.g. Tokyo, Paris)" />
  <button onclick="generateLocationData()">Generate</button>
  <pre id="output">Waiting for input...</pre>

  <script>
    async function generateLocationData() {
      const city = document.getElementById('cityInput').value.trim();
      const apiKey = 'e9b4f16a2a8f9f682f961e4c5c9abbe2';

      if (!city) {
        alert("Please enter a city.");
        return;
      }

      try {
        const geoRes = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(city)}&limit=1&appid=${apiKey}`);
        const geoData = await geoRes.json();

        if (!geoData || !geoData[0]) {
          throw new Error("City not found.");
        }

        const lat = geoData[0].lat;
        const lon = geoData[0].lon;
        const cityName = geoData[0].name;
        const country = geoData[0].country;

        const tzRes = await fetch(`https://api.ipgeolocation.io/timezone?apiKey=47903aad9884431ab4bdf98b3d32cfaa&lat=${lat}&long=${lon}`);
        const tzData = await tzRes.json();

        const timezone = tzData.timezone;

        const finalData = {
          city: cityName,
          country: country,
          timezone: timezone
        };

        document.getElementById("output").textContent =
          "üìã Copy this and paste into location.json:\n\n" +
          JSON.stringify(finalData, null, 2);

      } catch (err) {
        document.getElementById("output").textContent = "‚ùå Error: " + err.message;
      }
    }
  </script>
</body>
</html>
